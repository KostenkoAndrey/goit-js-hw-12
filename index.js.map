{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["`use strict`\n\nexport function createMarkup(array) {\n    return array.map(({ webformatURL: smallPic, largeImageURL: largePic, tags: alt, likes = 0, views = 0, comments = \"\", downloads = 0 }) => {\n        return `\n            <div class=\"galleries\">\n                <div class=\"loader\" style=\"display: block;\"></div> \n                <a href=\"${largePic}\">\n                    <img src=\"${smallPic}\" alt=\"${alt}\" />\n                </a>\n                <div class=\"content\">\n                    <div><p>Likes</p><span>${likes}</span></div>\n                    <div><p>Views</p><span>${views}</span></div>\n                    <div><p>Comments</p><span>${comments}</span></div>\n                    <div><p>Downloads</p><span>${downloads}</span></div>\n                </div>\n            </div>`;\n    }).join(\"\");\n}\n\nexport function setupImageLoadHandlers(container) {\n    const images = container.querySelectorAll('.galleries img');\n    images.forEach((img) => {\n        const loader = img.parentElement.previousElementSibling; // Получаем loader\n        img.onload = () => {\n            loader.style.display = 'none'; // Скрываем индикатор загрузки при успешной загрузке\n        };\n        img.onerror = () => {\n            loader.style.display = 'none'; // Скрываем индикатор загрузки при ошибке загрузки\n        };\n    });\n}\n","`use strict`\nimport axios from \"axios\";\n\nconst API_KEY = \"46815109-801c3b1dec2424a02adace61a\";\nconst BASE_URL = \"https://pixabay.com/api/\";\n// axios.defaults.headers.common[\"header-name\"] = API_KEY;\nexport let per_page = 15;\nexport async function fetchData(textRow, page = 1) {\n\nconst data = await axios.get(BASE_URL, {\n    params: {\n        key: API_KEY,\n        q: textRow,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page,\n        per_page,\n    }});\n\n    return data;\n}","'use strict';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { createMarkup, setupImageLoadHandlers } from \"./js/render-functions\";\nimport { fetchData, per_page } from \"./js/pixabay-api\";\n\nconst form = document.querySelector(\".form\");\nconst container = document.querySelector(\".gallery\");\nconst loadMore = document.querySelector(\".btn-add-more\")\nlet lightbox = null; \nlet page = 1;\n\nform.addEventListener(\"submit\", handleSearch);\n\nasync function handleSearch(event) {\n    event.preventDefault();\n    const { textRow } = event.target.elements;\n    page = 1;   \n    localStorage.setItem(\"searchItem\", JSON.stringify(textRow.value));\n\n    if (textRow.value.trim() === \"\") {\n        iziToast.warning({\n            title: 'Caution',\n            message: \"The search field cannot be empty.\",\n            color: \"red\",\n            position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n            maxWidth: \"300\",\n        });\n        return;\n    }\n\ntry {\n    const { data } = await fetchData(textRow.value);\n    \n    if (!data.hits.length) {\n    container.innerHTML = \"\";\n    loadMore.classList.add(\"js-hidden\");\n    iziToast.warning({\n    title: 'Caution',\n    message: '\"Sorry, there are no images matching your search query. Please try again!\"',\n    color: \"yellow\",\n    position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n    maxWidth: \"300\",\n});\n} else {\n    container.innerHTML = createMarkup(data.hits);\n    loadMore.classList.add(\"js-vissible\");\n    setupImageLoadHandlers(container);\n\n    if (lightbox) {\n        lightbox.refresh();\n    } else {\n    lightbox = new SimpleLightbox('.gallery .galleries a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n}}\n} catch (error) {\n    console.log(error.message);\n}\nform.reset();\n}\n\n\nloadMore.addEventListener(\"click\",  async () => {\nloadMore.disabled = true;\nconst dataitem = JSON.parse(localStorage.getItem(\"searchItem\"));\npage += 1;\n\ntry {\n    const { data } = await fetchData(dataitem, page);\n    const totalHits = data.totalHits;\n    const total = Math.ceil(totalHits / per_page);\n    if (page >= total){\n    loadMore.classList.replace(\"js-vissible\", \"js-hidden\");\n    iziToast.warning({\n    title: 'Caution',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    color: \"yellow\",\n    position: 'topRight', // bottomRight, bottomLeft, topRight, topLeft, topCenter, bottomCenter, center\n    maxWidth: \"300\",\n    });\n}\n    container.insertAdjacentHTML(\"beforeend\", createMarkup(data.hits));\n    const card = document.querySelector(\".galleries\");\n    const cardHeight = card.getBoundingClientRect().height; \n    window.scrollBy({\n        left: 0,\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n        });\n        setupImageLoadHandlers(container);\n        lightbox.refresh();\n} catch (error) {\n    console.error(\"Error loading more images:\", error.message);\n    iziToast.error({\n        title: 'Error',\n        message: \"An error occurred while loading more images. Please try again.\",\n        color: \"red\",\n        position: 'topRight',\n        maxWidth: \"300\",\n    });\n}finally {\n    loadMore.disabled = false;\n}\n});\n\n"],"names":["createMarkup","array","smallPic","largePic","alt","likes","views","comments","downloads","setupImageLoadHandlers","container","img","loader","API_KEY","BASE_URL","per_page","fetchData","textRow","page","axios","form","loadMore","lightbox","handleSearch","event","iziToast","data","SimpleLightbox","error","dataitem","totalHits","total","cardHeight"],"mappings":"owBAEO,SAASA,EAAaC,EAAO,CAChC,OAAOA,EAAM,IAAI,CAAC,CAAE,aAAcC,EAAU,cAAeC,EAAU,KAAMC,EAAK,MAAAC,EAAQ,EAAG,MAAAC,EAAQ,EAAG,SAAAC,EAAW,GAAI,UAAAC,EAAY,KACtH;AAAA;AAAA;AAAA,2BAGYL,CAAQ;AAAA,gCACHD,CAAQ,UAAUE,CAAG;AAAA;AAAA;AAAA,6CAGRC,CAAK;AAAA,6CACLC,CAAK;AAAA,gDACFC,CAAQ;AAAA,iDACPC,CAAS;AAAA;AAAA,mBAGrD,EAAE,KAAK,EAAE,CACd,CAEO,SAASC,EAAuBC,EAAW,CAC/BA,EAAU,iBAAiB,gBAAgB,EACnD,QAASC,GAAQ,CACpB,MAAMC,EAASD,EAAI,cAAc,uBACjCA,EAAI,OAAS,IAAM,CACfC,EAAO,MAAM,QAAU,MACnC,EACQD,EAAI,QAAU,IAAM,CAChBC,EAAO,MAAM,QAAU,MACnC,CACA,CAAK,CACL,CC5BA,MAAMC,EAAU,qCACVC,EAAW,2BAEV,IAAIC,EAAW,GACf,eAAeC,EAAUC,EAASC,EAAO,EAAG,CAa/C,OAXS,MAAMC,EAAM,IAAIL,EAAU,CACnC,OAAQ,CACJ,IAAKD,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAAH,CACH,CAAA,CAAC,CAGN,CCXA,MAAMK,EAAO,SAAS,cAAc,OAAO,EACrCV,EAAY,SAAS,cAAc,UAAU,EAC7CW,EAAW,SAAS,cAAc,eAAe,EACvD,IAAIC,EAAW,KACXJ,EAAO,EAEXE,EAAK,iBAAiB,SAAUG,CAAY,EAE5C,eAAeA,EAAaC,EAAO,CAC/BA,EAAM,eAAc,EACpB,KAAM,CAAE,QAAAP,CAAS,EAAGO,EAAM,OAAO,SAIjC,GAHAN,EAAO,EACP,aAAa,QAAQ,aAAc,KAAK,UAAUD,EAAQ,KAAK,CAAC,EAE5DA,EAAQ,MAAM,KAAI,IAAO,GAAI,CAC7BQ,EAAS,QAAQ,CACb,MAAO,UACP,QAAS,oCACT,MAAO,MACP,SAAU,WACV,SAAU,KACtB,CAAS,EACD,MACH,CAEL,GAAI,CACA,KAAM,CAAE,KAAAC,CAAI,EAAK,MAAMV,EAAUC,EAAQ,KAAK,EAEzCS,EAAK,KAAK,QAWfhB,EAAU,UAAYV,EAAa0B,EAAK,IAAI,EAC5CL,EAAS,UAAU,IAAI,aAAa,EACpCZ,EAAuBC,CAAS,EAE5BY,EACAA,EAAS,QAAO,EAEpBA,EAAW,IAAIK,EAAe,wBAAyB,CACvD,aAAc,MACd,aAAc,GAClB,CAAC,IApBGjB,EAAU,UAAY,GACtBW,EAAS,UAAU,IAAI,WAAW,EAClCI,EAAS,QAAQ,CACjB,MAAO,UACP,QAAS,6EACT,MAAO,SACP,SAAU,WACV,SAAU,KACd,CAAC,EAcD,OAASG,EAAO,CACZ,QAAQ,IAAIA,EAAM,OAAO,CAC7B,CACAR,EAAK,MAAK,CACV,CAGAC,EAAS,iBAAiB,QAAU,SAAY,CAChDA,EAAS,SAAW,GACpB,MAAMQ,EAAW,KAAK,MAAM,aAAa,QAAQ,YAAY,CAAC,EAC9DX,GAAQ,EAER,GAAI,CACA,KAAM,CAAE,KAAAQ,CAAI,EAAK,MAAMV,EAAUa,EAAUX,CAAI,EACzCY,EAAYJ,EAAK,UACjBK,EAAQ,KAAK,KAAKD,EAAYf,CAAQ,EACxCG,GAAQa,IACZV,EAAS,UAAU,QAAQ,cAAe,WAAW,EACrDI,EAAS,QAAQ,CACjB,MAAO,UACP,QAAS,6DACT,MAAO,SACP,SAAU,WACV,SAAU,KACd,CAAK,GAEDf,EAAU,mBAAmB,YAAaV,EAAa0B,EAAK,IAAI,CAAC,EAEjE,MAAMM,EADO,SAAS,cAAc,YAAY,EACxB,sBAAqB,EAAG,OAChD,OAAO,SAAS,CACZ,KAAM,EACN,IAAKA,EAAa,EAClB,SAAU,QAClB,CAAS,EACDvB,EAAuBC,CAAS,EAChCY,EAAS,QAAO,CACxB,OAASM,EAAO,CACZ,QAAQ,MAAM,6BAA8BA,EAAM,OAAO,EACzDH,EAAS,MAAM,CACX,MAAO,QACP,QAAS,iEACT,MAAO,MACP,SAAU,WACV,SAAU,KAClB,CAAK,CACL,QAAC,CACGJ,EAAS,SAAW,EACxB,CACA,CAAC"}